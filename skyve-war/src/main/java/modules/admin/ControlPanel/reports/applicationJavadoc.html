<#macro displayDocument module document>
<div class="page-break">
	<h2 id="${module.name}-${document.name}" class="section-title">${module.name} - ${document.singularAlias}</h2>

	<#if document.documentation?? && document.documentation?has_content>
	<div class="documentation-container">
		<div class="documentation-title">Documentation:</div>
		<div class="documentation-description">${document.documentation!?no_esc}</div>
	</div>
	</#if>
	
	<#if document.attributes?? && document.attributes?has_content>
	<div class="page-break-avoid section">
		<h3 id="${document.name}-attributes">Attributes</h3>
		<p>The document ${document.singularAlias} contains the following attributes:</p>
		<table class="table attributes repeat-headings" id="${document.name}-attributes" style="width: 100%; table-layout: fixed;">
			<thead>
				<tr>
					<th style="width:10%;">Attribute Name</th>
					<th style="width:10%;">Display Name</th>
					<th style="width:10%;">Type</th>
					<th style="width:10%;">Size</th>
					<th style="width:10%;">Required</th>
					<th style="width:10%;">Persistent</th>
					<th style="width:10%;">Description</th>
					<th style="width:10%;">Values</th>
					<th style="width:10%;">Deprecated</th>
				</tr>
			</thead>
			<tbody>
				<#list document.attributes as attribute>
				<tr>
					<td>${attribute.name}</td>
					<td>${attribute.displayName!}</td>
					<td>${attribute.type!}</td>
					<td>${attribute.size!}</td>
					<td>${attribute.required?c!}</td>
					<td>${attribute.persistent?c!}</td>
					<#if attribute.description?has_content>
					<td>${attribute.description!?no_esc}</td>
					<#else>
					<td></td>
					</#if>
					<#if attribute.values?? && attribute.values?has_content>
					<td>
							<#list attribute.values as value>
							<li>${value!}</li>
							</#list>
					</td>
					<#else>
					<td></td>
					</#if>
					<td>${attribute.deprecated?c!}</td>
				</tr>
				</#list>
			</tbody>
		</table>
	</div>
	</#if>

	<#if document.references?? && document.references?has_content>
	<div class="page-break-avoid section">
		<h3 id="${document.name}-references">References</h3>
		<p>The document ${document.singularAlias} contains the following references:</p>
		<table class="repeat-headings">
			<thead>
				<tr>
					<th>Reference</th>
					<th>Type</th>
					<th>Document</th>
					<th>Required</th>
					<th>Deprecated</th>
				</tr>
			</thead>
			<tbody>
				<#list document.references as reference>
				<tr>
					<td>${reference.name}</td>
					<td>${reference.type!}</td>
					<td>${reference.document!}</td>
					<td>${reference.required?c!}</td>
					<td>${reference.deprecated?c!}</td>
				</tr>
				</#list>
			</tbody>
		</table>
	</div>
	</#if>

	<#if document.conditions?? && document.conditions?has_content>
	<div class="page-break-avoid section">
		<h3 id="${document.name}-conditions">Conditions</h3>
		<p>The document ${document.singularAlias} contains the following conditions:</p>
		<table class="repeat-headings">
			<thead>
				<tr>
					<th>Name</th>
					<th>Documentation</th>
				</tr>
			</thead>
			<tbody>
				<#list document.conditions as condition>
				<tr>
					<td>${condition.name}</td>
					<td>${condition.documentation!?no_esc}</td>
				</tr>
				</#list>
			</tbody>
		</table>
	</div>
	</#if>

	<#if document.constraints?? && document.constraints?has_content>
	<div class="page-break-avoid section">
		<h3 id="${document.name}-constraints">Unique Constraints</h3>
		<p>The document ${document.singularAlias} contains the following
			constraints:</p>
		<table class="repeat-headings">
			<thead>
				<tr>
					<th>Constraint</th>
					<th>Description</th>
					<th>Scope</th>
					<th>References</th>
				</tr>
			</thead>
			<tbody>
				<#list document.constraints as constraint>
				<tr>
					<td>${constraint.name}</td>
					<td>${constraint.description!?no_esc}</td>
					<td>${constraint.scope!}</td>
					<td>${constraint.references!}</td>
				</tr>
				</#list>
			</tbody>
		</table>
	</div>
	</#if>

	<#if document.actions?? && document.actions?has_content>
	<div class="page-break-avoid section">
		<h3 id="${document.name}-actions">Actions</h3>
		<p>The document ${document.singularAlias} contains the following actions:</p>
		<ul>
			<#list document.actions as action>
			<li>${action.name}</li>
			</#list>
		</ul>
	</div>
	</#if>
</div>
</#macro>

<#macro displayModule module>
<div>
	<div>
		<h1 id="${module.name}" class="module-header">${module.name} module</h1>
	</div>


	<#if module.queries?? && module.queries?has_content>
	<h3 class="module-header" id="${module.name}-queries">Queries</h3>
	<p>The module ${module.name} contains the following queries:</p>
	<table style="margin-bottom : 50px;" class="page-break-avoid repeat-headings">
		<thead>
			<tr>
				<th>Query</th>
				<th>Driving Document</th>
				<th>Description</th>
				<th>Documentation</th>
			</tr>
		</thead>
		<tbody>
			<#assign row_index=0> <#list module.queries as query>
			<tr>
				<td>${query.name}</td>
				<td>${query.drivingDocument!}</td>
				<td>${query.description!?no_esc}</td>
				<td>${query.documentation!?no_esc}</td>
			</tr>
			<#assign row_index=row_index+1>
		        </#list>
		</tbody>
	</table>
	</#if>

	<#if module.roles?? && module.roles?has_content>
	<h3 class="module-header" id="${module.name}-roles">Roles</h3>
	<p>The module ${module.name} contains the following roles:</p>
	<table style="margin-bottom : 50px;" class="page-break-avoid repeat-headings">
		<thead>
			<tr>
				<th>Role</th>
				<th>Description</th>
				<th>Documentation</th>
			</tr>
		</thead>
		<tbody>
			<#assign row_index=0> <#list module.roles as role>
			<tr>
				<td>${role.name}</td>
				<td>${role.descrption!}</td>
				<td>${role.documentation!?no_esc}</td>
			</tr>
			<#assign row_index=row_index+1>
		        </#list>
		</tbody>
	</table>
	</#if>

	<#if module.jobs?? && module.jobs?has_content>
	<h3 class="module-header" id="${module.name}-jobs">Jobs</h3>
	<p>The module ${module.name} contains the following jobs:</p>
	<table style="margin-bottom : 50px;" class="page-break-avoid repeat-headings">
		<thead>
			<tr>
				<th>Name</th>
				<th>Job</th>
				<th>Class</th>
			</tr>
		</thead>
		<tbody>
			<#assign row_index=0>
			<#list module.jobs as job>
			<tr>
				<td>${job.name}</td>
				<td>${job.displayName!}</td>
				<td>${job.className!}</td>
			</tr>
			<#assign row_index=row_index+1>
		        </#list>
		</tbody>
	</table>
	</#if>

	<h3 class="module-header" id="${module.name}-documents">Documents</h3>
	<p>The module ${module.name} contains the following documents</p>
	<table style="margin-bottom : 50px;" class="page-break-avoid repeat-headings">
		<thead>
			<tr>
				<th>Document Name</th>
				<th>Documentation</th>
			</tr>
		</thead>
		<tbody>
			<#assign row_index=0> <#list module.documents as doc>
			<tr>
				<td>${doc.name}</td>
				<td>${doc.documentation!?no_esc}</td>
			</tr>
			<#assign row_index=row_index+1>
	        </#list>
		</tbody>
	</table>

	<#list module.documents as document> <@displayDocument module document /> </#list>
	
</div>
</#macro>


<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>${title}</title>
<#include "/reportBaseStyles.ftlh">
<#assign modules=data.modules>
<style>

@page {
        size: A4 portrait;
         @bottom-center{
         	content: "Version: ${pomVersion}";
            font-family: 'SourceSansPro', 'Arial', 'Microsoft Sans Serif', sans-serif;
            font-size: 10px;
            color: #333333;
         }
}
@page:first {
  @top-left {
  content: normal;
  }
 }
body {
	font-family: Arial, sans-serif;
	font-size: 12px;
}

table {
	border-collapse: collapse;
	border-spacing: 0;
}

table.attributes {
    border-collapse: collapse;
    width: 100%;
  }

  table.attributes th, table.attributes td {
    word-wrap: break-word;
    white-space: normal;
    font-size: 10px;
  }

h1 {
	font-size: 24px;
	color: ${defaultDarkColor!};
}

h2 {
	font-size: 20px;
}

h3 {
	font-size: 14px;
}

.document-documentation {
	padding: 5px;
}

.documentation-container {
	display: table;
	background-color: white;
	max-width: 800px;
	box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.documentation-title {
	display: table-cell;
	font-weight: bold;
	color: #333;
	width: 100px;
	vertical-align: top;
	padding-right: 10px;
}

.documentation-description {
	display: table-cell;
	color: #555;
	text-align: justify;
}

thead {
	background-color: ${defaultColor!};
}

tbody tr:nth-child(even) {
	background-color: ${defaultLightColor!};
}

thead th.title {
	text-align: center;
}

td, th {
	padding-left: 5px;
	max-width: 50px;
}

.module-header {
	padding: 10px;
	text-align: center;
	text-decoration: underline;
	color: ${defaultDarkColor!};
}

h3.module-header{
	text-align: left;
	text-decoration: none ;
	padding : 0;
	margin-top: 10px;
}

.section{
	margin-bottom : 50px;
}

.section-title {
	color: ${defaultDarkColor!};
	text-align:center;
	padding:5px;
	font-weight : bold;
}

.toc a {
	text-decoration: none;
}

.toc li>a {
	text-decoration: inherit;
	color: inherit;
	font-family: inherit;
}

.toc h1 {
	margin-bottom: 20px;
	text-align: center;
	font-size: 28px;
}

  .toc h3 {
    font-size: 18px;
  }

  .toc h4 {
    font-size: 14px;
  }

  .toc a {
    font-size: 14px;
  }

  .toc ul, .toc ol {
    font-size: 14px;
  }

.toc-section-contents-documents>ol>li {
	margin-right: 10px;
	list-style-position: outside;
}

.toc-section-contents-documents>ol>li>h4 {
	background-color: ${defaultColor!};
	padding-left:5px;
	color:white;
}

.toc-section-contents-documents>ol>li>h4 a {
	color: inherit;
}

.toc-section-contents-documents ul>li {
	margin-bottom: 5px;
	list-style-type: circle;
	border-bottom: 1px dotted ${defaultColor!};
}

.toc-module-title {
	margin-bottom: 5px;
	color: ${defaultColor!};
}

.toc-section-contents {
	padding: 0;
	width: 100%;
}

</style>
</head>
<body>

	<#-- Title Page -->
	<div style="page-break-after: always; width: 100%; height: 100%; text-align: center; font-family: Arial, sans-serif;">
	    <table style="width: 100%; height: 100%;  border: none; margin: 0; padding: 0;">
	        <tr>
	            <td style="vertical-align: middle; text-align: center;">
	                <@image filename="skyve-logo-black.png" alt="Skyve Logo" height="40" />
	                <h1 style="font-size: 36px; margin-bottom: 10px;">${projectName}</h1>
	                <h2 style="font-size: 24px; color: gray;">System Documentation Report</h2>
	                <p style="font-size: 18px; margin-top: 40px;">Generated on: ${.now}</p>
	            </td>
	        </tr>
	    </table>
	</div>


	<header>
		<div class="logo"><@image filename="skyve-logo-black.png"
			alt="Skyve Logo" height="40" /></div>
		<div class="company">
			<h2 class="name" style="font-size: 18px;">${title}</h2>
		</div>
	</header>
	<div class="toc">
		<h1>Table of Contents</h1>
		<div class="toc-section">
			<div class="toc-section-contents">
				<ol>
					<#list modules as module>
					<li style="list-style-type: upper-alpha;">
						<h3>
							<a class="toc-module-title" href="#${module.name}">${module.name} module</a>
						</h3>
						<ul style="list-style-type: disc;">
							<#if module.queries?? && module.queries?has_content>
								<li><a class="toc-module-title" href="#${module.name}-queries">Queries</a></li>
							</#if>
							
							<#if module.roles?? && module.roles?has_content>
							<li><a href="#${module.name}-roles">Roles</a></li>
							</#if>
							
							<#if module.jobs?? && module.jobs?has_content>
							<li><a href="#${module.name}-jobs">Jobs</a></li>
							</#if>
							
							<#if module.documents?? && module.documents?has_content>
							<li><a href="#${module.name}-documents">Documents</a></li>
							</#if>
						</ul>

						<div class="toc-section-contents-documents"
							style="page-break-after: always">
							<ol>
								<#list module.documents as document>
								<li>
									<h4>
										<a class="toc-module-title"
											href="#${module.name}-${document.name}">${document.singularAlias}</a>
									</h4>
									<ul>
										<#if document.attributes?? && document.attributes?has_content>
										<li><a class="toc-module-title"
											href="#${document.name}-attributes">Attributes</a></li>
										</#if>
										<#if document.references?? && document.references?has_content>
										<li><a class="toc-module-title"
											href="#${document.name}-references">References</a></li>
										</#if>
										<#if document.conditions?? && document.conditions?has_content>
										<li><a class="toc-module-title"
											href="#${document.name}-conditions">Conditions</a></li>
										</#if>
										<#if
											document.constraints?? && document.constraints?has_content>
										<li><a class="toc-module-title"
											href="#${document.name}-constraints">Constraints</a></li>
										</#if>
										<#if document.actions?? && document.actions?has_content>
										<li><a class="toc-module-title"
											href="#${document.name}-actions">Actions</a></li>
										</#if>
									</ul>
								</li>
								</#list>
							</ol>
						</div>
					</li>
					</#list>
				</ol>
			</div>
		</div>

	</div>

	<#list modules as module> <@displayModule module /> </#list>
</body>
</html>