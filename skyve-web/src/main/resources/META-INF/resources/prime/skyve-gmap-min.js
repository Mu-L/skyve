SKYVE.BizMap=function(){var a={};var b=function(d,c){$.get(d.url,function(e){SKYVE.Util.scatterGMap(d,e,true,false)})};return{create:function(e){var d={zoom:4,center:new google.maps.LatLng(-26,133.5),mapTypeId:google.maps.MapTypeId.ROADMAP};var f=a[e.elementId];if(f){if(f.webmap){d.zoom=f.webmap.getZoom();d.center=f.webmap.getCenter();d.mapTypeId=f.webmap.getMapTypeId()}}else{f={_objects:{},_overlays:[],click:function(g,h){SKYVE.BizMap.click(this,g,h)}};a[e.elementId]=f}f.infoWindow=new google.maps.InfoWindow({content:""});f.webmap=new google.maps.Map(SKYVE.PF.getByIdEndsWith(e.elementId)[0],d);var c=SKYVE.Util.CONTEXT_URL+"map?";if(e.modelName){c+="_c="+e._c+"&_m="+e.modelName}else{if(e.queryName){c+="_mod="+e.moduleName+"&_q="+e.queryName+"&_geo="+e.geometryBinding}}f.url=c;b(f,true);return f},get:function(c){return a[c]},click:function(j,i,d){var f=i.infoMarkup;f+='<br/><br/><input type="button" value="Zoom" onclick="window.location=\''+SKYVE.Util.CONTEXT_URL;f+="?m="+i.mod+"&d="+i.doc+"&i="+i.bizId+"'\"/>";if(i.getPosition){j.infoWindow.open(this.webmap,i);j.infoWindow.setContent(f)}else{if(i.getPath){var c=new google.maps.LatLngBounds();var m=i.getPath();for(var h=0,e=m.getLength();h<e;h++){c.extend(m.getAt(h))}var g=c.getNorthEast();var l=c.getSouthWest();j.infoWindow.setPosition(d.latLng);j.infoWindow.open(j.webmap);j.infoWindow.setContent(f)}}}}}();SKYVE.BizMapPicker=function(){var a={};return{create:function(d){var c={zoom:4,center:new google.maps.LatLng(-26,133.5),mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU}};var f=a[d.elementId];if(f){if(f.webmap){c.zoom=f.webmap.getZoom();c.center=f.webmap.getCenter();c.mapTypeId=f.webmap.getMapTypeId()}}else{f={_objects:{},_overlays:[]};a[d.elementId]=f}var b=SKYVE.PF.getByIdEndsWith(d.elementId).attr("id");f.webmap=new google.maps.Map(document.getElementById(b),c);if(!d.disabled){var e={editable:true,strokeColor:"#990000",fillColor:"#EEFFCC",fillOpacity:0.6};f.webmap.drawingManager=new google.maps.drawing.DrawingManager({drawingControlOptions:{position:google.maps.ControlPosition.LEFT_BOTTOM,defaults:e,drawingModes:SKYVE.Util.gmapDrawingModes(d.drawingTools)},markerOptions:e,polygonOptions:e,polylineOptions:e,rectangleOptions:e});f.webmap.drawingManager.setMap(f.webmap);google.maps.event.addListener(f.webmap.drawingManager,"overlaycomplete",function(i){SKYVE.Util.clearGMap(f);this.setDrawingMode(null);f._overlays.push(i.overlay);var h=new Wkt.Wkt();h.fromObject(i.overlay);var g=h.write();SKYVE.PF.setTextValue(b+"_value",g)})}SKYVE.Util.clearGMap(f);SKYVE.Util.scatterGMapValue(f,SKYVE.PF.getTextValue(b+"_value"))}}}();